import commander from 'commander';
import { echo } from 'shelljs';

import prerequisite from './prerequisite';

import setup from './tasks/setup';
import install from './tasks/install';
import mount from './tasks/mount';

prerequisite.checkGit();
prerequisite.checkNpm();

commander
  .option('-s, --setup', 'Setup')
  .option('-l --link', 'Link up dotfiles in ~ folder')
  .option('-i --install [value]', 'Install')
  .option('-b --brew', 'Install Brew packages')
  .option('-n --npm', 'Install Node packages')
  .option('-a --atom', 'Install Atom packages')
  .option('-t --test', 'Test Commander')
  .parse(process.argv);

if (commander.setup) {
  setup.brew();
  setup.osx();
  setup.dev();
}

if (commander.link) {
  mount.link();
}

const fullInstall = commander.install && !commander.install.length;
const toInstall = commander.install || [];

if (fullInstall || toInstall.indexOf('brew') > -1) {
  install.brew();
}

if (fullInstall || toInstall.indexOf('npm') > -1) {
  install.node();
}

if (fullInstall || toInstall.indexOf('atom') > -1) {
  install.atom();
}

if (commander.test) {
  echo('This is a test');
}

mount.source();
